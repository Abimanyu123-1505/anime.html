<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OtakuTrack - Anime, Manga & Manhwa Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #6a0dad;
            --primary-hover: #5a0b9d;
            --secondary-color: #4b0082;
            --accent-color: #9370db;
            --accent-hover: #8360cb;
            --light-bg: #f8f9fa;
            --dark-text: #212529;
            --card-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            --transition-fast: all 0.2s ease;
            --transition-medium: all 0.3s ease;
            --transition-slow: all 0.5s ease;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light-bg);
            color: var(--dark-text);
            overflow-x: hidden;
        }
        
        .navbar {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: var(--transition-medium);
        }
        
        .navbar.scrolled {
            padding-top: 5px;
            padding-bottom: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.8rem;
            background: linear-gradient(to right, #fff, #ddd);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: var(--transition-medium);
        }
        
        .navbar-brand:hover {
            transform: scale(1.05);
        }
        
        .nav-link {
            position: relative;
            padding: 8px 15px;
            transition: var(--transition-fast);
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 15px;
            width: 0;
            height: 2px;
            background-color: white;
            transition: var(--transition-medium);
        }
        
        .nav-link:hover::after {
            width: calc(100% - 30px);
        }
        
        .card {
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            transition: var(--transition-medium);
            margin-bottom: 20px;
            height: 100%;
            border: none;
            overflow: hidden;
            background-color: white;
        }
        
        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        
        .card-img-top {
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
            height: 320px;
            object-fit: cover;
            transition: var(--transition-slow);
        }
        
        .card:hover .card-img-top {
            transform: scale(1.05);
        }
        
        .progress {
            height: 10px;
            border-radius: 5px;
            background-color: #e9ecef;
        }
        
        .progress-bar {
            background-color: var(--accent-color);
            transition: width 0.6s ease;
        }
        
        .trending-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #ff4757;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            z-index: 2;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .rating-stars {
            color: #ffc107;
        }
        
        .forum-comment {
            border-left: 3px solid var(--accent-color);
            padding-left: 10px;
            margin-bottom: 15px;
            transition: var(--transition-fast);
        }
        
        .forum-comment:hover {
            border-left-width: 6px;
            padding-left: 13px;
        }
        
        .suggestion-card {
            cursor: pointer;
        }
        
        #searchResults, #newTitleResults {
            position: absolute;
            width: 100%;
            z-index: 1000;
            display: none;
            max-height: 400px;
            overflow-y: auto;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .media-type-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 0.7rem;
            font-weight: bold;
            color: white;
            z-index: 2;
        }
        
        .anime-badge {
            background-color: #e63946;
        }
        
        .manga-badge {
            background-color: #1d3557;
        }
        
        .manhwa-badge {
            background-color: #457b9d;
        }
        
        .novel-badge {
            background-color: #2a9d8f;
        }
        
        .progress-container {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
            transition: var(--transition-medium);
        }
        
        .progress-container:hover {
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .progress-details {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .progress-input-group {
            flex: 1;
        }
        
        .progress-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .media-cover {
            width: 80px;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            transition: var(--transition-medium);
        }
        
        .media-cover:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .progress-item {
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
            margin-bottom: 15px;
            transition: var(--transition-fast);
        }
        
        .progress-item:hover {
            background-color: rgba(0, 0, 0, 0.02);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        /* Button styles */
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            transition: var(--transition-fast);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-hover);
            border-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn-outline-primary {
            color: var(--primary-color);
            border-color: var(--primary-color);
            transition: var(--transition-fast);
        }
        
        .btn-outline-primary:hover {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn-accent {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
            transition: var(--transition-fast);
        }
        
        .btn-accent:hover {
            background-color: var(--accent-hover);
            border-color: var(--accent-hover);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* Form elements */
        .form-control, .form-select {
            border-radius: 8px;
            padding: 10px 15px;
            transition: var(--transition-fast);
            border: 1px solid #ced4da;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 0.25rem rgba(106, 13, 173, 0.25);
        }
        
        /* Accessibility improvements */
        :focus {
            outline: 3px solid var(--accent-color);
            outline-offset: 2px;
        }
        
        .card-title, h1, h2, h3, h4, h5, h6 {
            color: #1a1a1a;
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        /* Loading animation */
        .loading-spinner {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            vertical-align: text-bottom;
            border: 0.25em solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spinner-border .75s linear infinite;
        }
        
        @keyframes spinner-border {
            to { transform: rotate(360deg); }
        }
        
        /* Floating action button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 100;
            transition: var(--transition-medium);
            cursor: pointer;
        }
        
        .fab:hover {
            transform: scale(1.1) translateY(-5px);
            background-color: var(--primary-hover);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .progress-details {
                flex-direction: column;
                gap: 10px;
            }
            
            .card-img-top {
                height: 240px;
            }
            
            .navbar-brand {
                font-size: 1.5rem;
            }
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --light-bg: #121212;
                --dark-text: #f8f9fa;
            }
            
            body {
                background-color: var(--light-bg);
                color: var(--dark-text);
            }
            
            .card, .progress-container {
                background-color: #1e1e1e;
                color: var(--dark-text);
                border: 1px solid #333;
            }
            
            .text-muted {
                color: #adb5bd !important;
            }
            
            .navbar {
                background: linear-gradient(135deg, #4b0082, #2d004d);
            }
            
            .list-group-item {
                background-color: #2d2d2d;
                color: var(--dark-text);
                border-color: #444;
            }
            
            .form-control, .form-select {
                background-color: #2d2d2d;
                color: white;
                border-color: #444;
            }
            
            .progress {
                background-color: #333;
            }
            
            .progress-item:hover {
                background-color: rgba(255, 255, 255, 0.05);
            }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }
        
        /* Animation classes */
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        .slide-up {
            animation: slideUp 0.5s ease forwards;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Badge animations */
        .badge {
            transition: var(--transition-fast);
        }
        
        .badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        /* Section headers */
        .section-header {
            position: relative;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .section-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            border-radius: 3px;
        }
        
        /* Floating notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: #4CAF50;
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1050;
            transform: translateX(200%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <!-- Skip to content link for accessibility -->
    <a href="#main-content" class="sr-only sr-only-focusable">Skip to main content</a>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark mb-4 fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">OtakuTrack</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" aria-current="page"><i class="fas fa-home" aria-hidden="true"></i> Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-list" aria-hidden="true"></i> My List</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-fire" aria-hidden="true"></i> Trending</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-comments" aria-hidden="true"></i> Forum</a>
                    </li>
                </ul>
                <div class="d-flex position-relative">
                    <input class="form-control me-2" type="search" placeholder="Search anime, manga..." id="searchInput" aria-label="Search anime and manga">
                    <button class="btn btn-outline-light" type="button" id="searchButton" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></button>
                    <div class="list-group" id="searchResults" role="listbox" aria-labelledby="searchInput"></div>
                </div>
                <ul class="navbar-nav ms-3">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user-circle" aria-hidden="true"></i> Profile
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="#">Account</a></li>
                            <li><a class="dropdown-item" href="#">Settings</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#">Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Floating Action Button -->
    <div class="fab" id="quickAddBtn" title="Quick Add">
        <i class="fas fa-plus"></i>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        Progress updated successfully!
    </div>

    <main id="main-content" class="container" role="main" style="padding-top: 80px;">
        <!-- Progress Update Section -->
        <div class="progress-container slide-up">
            <div class="progress-header">
                <h2 class="section-header">Update Your Progress</h2>
                <button class="btn btn-sm btn-primary" id="addNewProgressBtn">
                    <i class="fas fa-plus" aria-hidden="true"></i> Add New
                </button>
            </div>
            
            <!-- Current Progress Items will be loaded here -->
            <div id="currentProgressItems">
                <div class="text-center py-4">
                    <div class="loading-spinner text-primary" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <p>Loading your progress...</p>
                </div>
            </div>
            
            <!-- Add New Progress Form (Hidden by default) -->
            <div class="add-new-progress" style="display: none;">
                <h3 class="mb-3">Add New Title to Track</h3>
                <div class="mb-3">
                    <label for="newTitleSearch" class="form-label">Search for Title</label>
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search anime, manga, manhwa, or novel" id="newTitleSearch" aria-label="Search for media title">
                        <button class="btn btn-outline-secondary" type="button" id="newTitleSearchButton">
                            <i class="fas fa-search" aria-hidden="true"></i>
                        </button>
                    </div>
                    <div class="list-group mt-2" id="newTitleResults" style="display: none;"></div>
                </div>
                
                <div class="row g-3">
                    <div class="col-md-4">
                        <label for="mediaTypeSelect" class="form-label">Media Type</label>
                        <select class="form-select" id="mediaTypeSelect" aria-label="Select media type">
                            <option value="anime">Anime</option>
                            <option value="manga">Manga</option>
                            <option value="manhwa" selected>Manhwa</option>
                            <option value="novel">Novel</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label for="currentProgressInput" class="form-label">Current Chapter/Episode</label>
                        <input type="number" class="form-control" min="1" value="1" id="currentProgressInput" aria-label="Current progress">
                    </div>
                    <div class="col-md-4">
                        <label for="totalProgressInput" class="form-label">Total Chapters/Episodes</label>
                        <input type="number" class="form-control" min="1" placeholder="Leave blank if unknown" id="totalProgressInput" aria-label="Total chapters or episodes">
                    </div>
                </div>
                
                <div class="mt-3">
                    <label for="statusSelect" class="form-label">Status</label>
                    <select class="form-select" id="statusSelect" aria-label="Select status">
                        <option value="watching" selected>Watching</option>
                        <option value="reading">Reading</option>
                        <option value="completed">Completed</option>
                        <option value="on_hold">On Hold</option>
                        <option value="dropped">Dropped</option>
                        <option value="plan_to_watch">Plan to Watch</option>
                        <option value="plan_to_read">Plan to Read</option>
                    </select>
                </div>
                
                <div class="mt-3 d-flex justify-content-end gap-2">
                    <button class="btn btn-outline-secondary" id="cancelAddProgressBtn">
                        Cancel
                    </button>
                    <button class="btn btn-primary" id="confirmAddProgressBtn" disabled>
                        <i class="fas fa-plus" aria-hidden="true"></i> Add Title
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Main Dashboard -->
        <div class="row mb-4">
            <div class="col-md-8">
                <h2 class="section-header">Continue Watching/Reading</h2>
                <div class="row" id="continue-watching">
                    <!-- Content will be loaded dynamically -->
                    <div class="col-12 text-center py-4">
                        <div class="loading-spinner text-primary" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                        <p>Loading your continue watching list...</p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4">
                <h2 class="section-header">Upcoming Releases</h2>
                <div class="list-group" id="upcoming-releases">
                    <!-- Content will be loaded dynamically -->
                    <div class="list-group-item text-center py-4">
                        <div class="loading-spinner text-primary" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                        <p>Loading upcoming releases...</p>
                    </div>
                </div>
                
                <h2 class="section-header mt-4">Quick Stats</h2>
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Anime Watching:</span>
                            <span id="anime-count">0</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Manga Reading:</span>
                            <span id="manga-count">0</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Manhwa Reading:</span>
                            <span id="manhwa-count">0</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Novels Reading:</span>
                            <span id="novel-count">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Recommendations Section -->
        <h2 class="section-header">Recommended For You</h2>
        <div class="row mb-4" id="recommendations">
            <!-- Content will be loaded dynamically -->
            <div class="col-12 text-center py-4">
                <div class="loading-spinner text-primary" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
                <p>Loading recommendations...</p>
            </div>
        </div>
        
        <!-- Forum Section -->
        <h2 class="section-header">Recent Forum Discussions</h2>
        <div class="row" id="forum-discussions">
            <!-- Content will be loaded dynamically -->
            <div class="col-12 text-center py-4">
                <div class="loading-spinner text-primary" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
                <p>Loading forum discussions...</p>
            </div>
        </div>
    </main>
    
    <!-- Update Progress Modal -->
    <div class="modal fade" id="progressModal" tabindex="-1" aria-labelledby="progressModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title h5" id="progressModalLabel">Update Progress</h2>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="progressForm">
                        <div class="mb-3">
                            <label for="mediaTitle" class="form-label">Title</label>
                            <input type="text" class="form-control" id="mediaTitle" readonly>
                        </div>
                        <div class="mb-3">
                            <label for="currentChapter" class="form-label">Current Chapter/Episode</label>
                            <input type="number" class="form-control" id="currentChapter" min="1">
                        </div>
                        <div class="mb-3">
                            <label for="totalChapters" class="form-label">Total Chapters/Episodes</label>
                            <input type="number" class="form-control" id="totalChapters" min="1">
                        </div>
                        <div class="mb-3">
                            <label for="userRating" class="form-label">Your Rating</label>
                            <select class="form-select" id="userRating" aria-label="Select your rating">
                                <option value="5">5 - Excellent</option>
                                <option value="4" selected>4 - Great</option>
                                <option value="3">3 - Good</option>
                                <option value="2">2 - Fair</option>
                                <option value="1">1 - Poor</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="statusSelectModal" class="form-label">Status</label>
                            <select class="form-select" id="statusSelectModal" aria-label="Select status">
                                <option value="watching">Watching</option>
                                <option value="reading">Reading</option>
                                <option value="completed">Completed</option>
                                <option value="on_hold">On Hold</option>
                                <option value="dropped">Dropped</option>
                                <option value="plan_to_watch">Plan to Watch</option>
                                <option value="plan_to_read">Plan to Read</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveProgressBtn">Save Changes</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h3 class="h5">About OtakuTrack</h3>
                    <p>Track your anime, manga, manhwa, and novel progress. Discover new titles and connect with other fans.</p>
                </div>
                <div class="col-md-4">
                    <h3 class="h5">Quick Links</h3>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white">API Documentation</a></li>
                        <li><a href="#" class="text-white">Privacy Policy</a></li>
                        <li><a href="#" class="text-white">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h3 class="h5">Connect With Us</h3>
                    <div class="social-icons">
                        <a href="#" class="text-white me-2" aria-label="Twitter"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
                        <a href="#" class="text-white me-2" aria-label="Discord"><i class="fab fa-discord fa-lg" aria-hidden="true"></i></a>
                        <a href="#" class="text-white me-2" aria-label="Reddit"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a>
                        <a href="#" class="text-white" aria-label="GitHub"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
                    </div>
                </div>
            </div>
            <hr>
            <div class="text-center">
                <p class="mb-0">&copy; 2023 OtakuTrack. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // API configurations
        const API_CONFIG = {
            anime: {
                baseUrl: 'https://api.hianime.to/api',
                endpoints: {
                    search: '/search',
                    top: '/top',
                    details: '/info'
                }
            },
            manga: {
                baseUrl: 'https://api.mangadex.org',
                endpoints: {
                    search: '/manga',
                    top: '/manga',
                    details: '/manga'
                }
            },
            manhwa: {
                baseUrl: 'https://api.mangadex.org',
                endpoints: {
                    search: '/manga',
                    top: '/manga',
                    details: '/manga'
                }
            },
            novel: {
                baseUrl: 'https://api.novelupdates.com',
                endpoints: {
                    search: '/search',
                    top: '/top',
                    details: '/series'
                }
            }
        };

        // Sample data for demonstration
        const SAMPLE_DATA = {
            anime: [
                {
                    id: 'jujutsu-kaisen',
                    title: 'Jujutsu Kaisen',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/bx113415-bbBWj4pEFseh.jpg',
                    type: 'anime',
                    rating: 8.8,
                    currentEpisode: 12,
                    totalEpisodes: 24,
                    genres: ['Action', 'Fantasy', 'Supernatural']
                },
                {
                    id: 'demon-slayer',
                    title: 'Demon Slayer: Kimetsu no Yaiba',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/bx101922-PEn1CTc93blC.jpg',
                    type: 'anime',
                    rating: 8.7,
                    currentEpisode: 18,
                    totalEpisodes: 26,
                    genres: ['Action', 'Fantasy', 'Historical']
                }
            ],
            manga: [
                {
                    id: 'berserk',
                    title: 'Berserk',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/bx1-TWenPqsncPq8.jpg',
                    type: 'manga',
                    rating: 9.3,
                    currentChapter: 145,
                    totalChapters: null,
                    genres: ['Action', 'Adventure', 'Fantasy', 'Horror']
                },
                {
                    id: 'one-piece',
                    title: 'One Piece',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/bx13-7xV3uQzVuV6Y.jpg',
                    type: 'manga',
                    rating: 8.9,
                    currentChapter: 1071,
                    totalChapters: null,
                    genres: ['Action', 'Adventure', 'Comedy', 'Fantasy']
                }
            ],
            manhwa: [
                {
                    id: 'solo-leveling',
                    title: 'Solo Leveling',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/bx9135-7V8UGLRp9aIk.jpg',
                    type: 'manhwa',
                    rating: 8.6,
                    currentChapter: 145,
                    totalChapters: 179,
                    genres: ['Action', 'Adventure', 'Fantasy']
                },
                {
                    id: 'tower-of-god',
                    title: 'Tower of God',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/bx95-QWQvzF3Uv6iz.jpg',
                    type: 'manhwa',
                    rating: 8.4,
                    currentChapter: 523,
                    totalChapters: null,
                    genres: ['Action', 'Adventure', 'Drama', 'Fantasy']
                }
            ],
            novel: [
                {
                    id: 'the-beginning-after-the-end',
                    title: 'The Beginning After the End',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/bx103851-2QHp3GZcKZ1y.jpg',
                    type: 'novel',
                    rating: 8.5,
                    currentChapter: 350,
                    totalChapters: null,
                    genres: ['Action', 'Adventure', 'Fantasy']
                },
                {
                    id: 'omniscient-readers-viewpoint',
                    title: 'Omniscient Reader\'s Viewpoint',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/bx101612-2QHp3GZcKZ1y.jpg',
                    type: 'novel',
                    rating: 8.9,
                    currentChapter: 551,
                    totalChapters: null,
                    genres: ['Action', 'Adventure', 'Drama', 'Fantasy']
                }
            ],
            upcoming: [
                {
                    title: 'Jujutsu Kaisen - Episode 23',
                    days: 1
                },
                {
                    title: 'Solo Leveling - Chapter 146',
                    days: 2
                },
                {
                    title: 'Chainsaw Man - Chapter 112',
                    days: 3
                },
                {
                    title: 'One Piece - Episode 1072',
                    days: 6
                }
            ],
            recommendations: [
                {
                    id: 'chainsaw-man',
                    title: 'Chainsaw Man',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/bx105778-5ZQPqCz92jQq.jpg',
                    type: 'manga',
                    rating: 9.1,
                    reason: 'Trending in your network',
                    genres: ['Action', 'Horror', 'Supernatural']
                },
                {
                    id: 'hunter-x-hunter',
                    title: 'Hunter x Hunter',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/bx11061-4u91h9YtQ8xS.jpg',
                    type: 'anime',
                    rating: 9.0,
                    reason: 'Based on your history',
                    genres: ['Action', 'Adventure', 'Fantasy']
                },
                {
                    id: 'the-beginning-after-the-end',
                    title: 'The Beginning After the End',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/bx103851-2QHp3GZcKZ1y.jpg',
                    type: 'novel',
                    rating: 8.5,
                    reason: 'Popular in your region',
                    genres: ['Action', 'Adventure', 'Fantasy']
                },
                {
                    id: 'attack-on-titan',
                    title: 'Attack on Titan',
                    image: 'https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/bx16498-8Y8wXbIBWYlQ.jpg',
                    type: 'anime',
                    rating: 8.9,
                    reason: 'Similar to your watched titles',
                    genres: ['Action', 'Drama', 'Fantasy', 'Horror']
                }
            ],
            forum: [
                {
                    title: 'Jujutsu Kaisen Episode 22 Discussion',
                    comment: 'The animation in this episode was absolutely insane! That fight sequence...',
                    user: 'User123',
                    time: '3 hours ago',
                    comments: 45
                },
                {
                    title: 'Solo Leveling Chapter 145 Theories',
                    comment: 'I think Jin-Woo is about to face his biggest challenge yet when...',
                    user: 'ShadowMonarch',
                    time: '5 hours ago',
                    comments: 112
                }
            ]
        };

        // Progress Tracker Class
        class ProgressTracker {
            constructor() {
                this.userProgress = JSON.parse(localStorage.getItem('otakuTrackProgress')) || {};
                this.currentMedia = null;
            }

            saveProgress(mediaId, mediaType, progress) {
                if (!this.userProgress[mediaType]) {
                    this.userProgress[mediaType] = {};
                }
                
                this.userProgress[mediaType][mediaId] = progress;
                localStorage.setItem('otakuTrackProgress', JSON.stringify(this.userProgress));
                return true;
            }

            getProgress(mediaId, mediaType) {
                return this.userProgress[mediaType]?.[mediaId] || {
                    current: 0,
                    total: null,
                    status: mediaType === 'anime' ? 'plan_to_watch' : 'plan_to_read',
                    rating: null
                };
            }

            async getMedia(mediaId, mediaType) {
                // In a real app, this would fetch from the API
                // For now, we'll use our sample data
                let media = null;
                
                if (mediaType === 'anime') {
                    media = SAMPLE_DATA.anime.find(item => item.id === mediaId);
                } else if (mediaType === 'manga') {
                    media = SAMPLE_DATA.manga.find(item => item.id === mediaId);
                } else if (mediaType === 'manhwa') {
                    media = SAMPLE_DATA.manhwa.find(item => item.id === mediaId);
                } else if (mediaType === 'novel') {
                    media = SAMPLE_DATA.novel.find(item => item.id === mediaId);
                }
                
                if (!media) {
                    // If not found in sample data, create a generic entry
                    media = {
                        id: mediaId,
                        title: mediaId.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' '),
                        image: mediaType === 'anime' ? 'https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/default.jpg' :
                              mediaType === 'manga' ? 'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/default.jpg' :
                              mediaType === 'manhwa' ? 'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/default.jpg' :
                              'https://s4.anilist.co/file/anilistcdn/media/manga/cover/large/default.jpg',
                        type: mediaType,
                        rating: Math.floor(Math.random() * 2) + 7 + Math.random(),
                        genres: ['Action', 'Adventure', 'Fantasy']
                    };
                }
                
                return media;
            }

            getAllProgress() {
                return this.userProgress;
            }

            removeProgress(mediaId, mediaType) {
                if (this.userProgress[mediaType]?.[mediaId]) {
                    delete this.userProgress[mediaType][mediaId];
                    localStorage.setItem('otakuTrackProgress', JSON.stringify(this.userProgress));
                    return true;
                }
                return false;
            }
        }

        // Initialize tracker
        const tracker = new ProgressTracker();
        const progressModal = new bootstrap.Modal(document.getElementById('progressModal'));

        // DOM Elements
        const elements = {
            searchInput: document.getElementById('searchInput'),
            searchResults: document.getElementById('searchResults'),
            currentProgressItems: document.getElementById('currentProgressItems'),
            addNewProgressBtn: document.getElementById('addNewProgressBtn'),
            cancelAddProgressBtn: document.getElementById('cancelAddProgressBtn'),
            confirmAddProgressBtn: document.getElementById('confirmAddProgressBtn'),
            newTitleSearch: document.getElementById('newTitleSearch'),
            newTitleResults: document.getElementById('newTitleResults'),
            mediaTypeSelect: document.getElementById('mediaTypeSelect'),
            currentProgressInput: document.getElementById('currentProgressInput'),
            totalProgressInput: document.getElementById('totalProgressInput'),
            statusSelect: document.getElementById('statusSelect'),
            saveProgressBtn: document.getElementById('saveProgressBtn'),
            mediaTitle: document.getElementById('mediaTitle'),
            currentChapter: document.getElementById('currentChapter'),
            totalChapters: document.getElementById('totalChapters'),
            userRating: document.getElementById('userRating'),
            statusSelectModal: document.getElementById('statusSelectModal'),
            continueWatching: document.getElementById('continue-watching'),
            upcomingReleases: document.getElementById('upcoming-releases'),
            recommendations: document.getElementById('recommendations'),
            forumDiscussions: document.getElementById('forum-discussions'),
            quickAddBtn: document.getElementById('quickAddBtn'),
            notification: document.getElementById('notification')
        };

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            loadUserProgress();
            loadDashboardContent();
            setupEventListeners();
            setupScrollListener();
        });

        function setupEventListeners() {
            // Search functionality
            elements.searchInput.addEventListener('input', debounce(handleSearch, 300));
            document.getElementById('searchButton').addEventListener('click', () => handleSearch(elements.searchInput.value));

            // Progress tracking
            elements.addNewProgressBtn.addEventListener('click', showAddProgressForm);
            elements.cancelAddProgressBtn.addEventListener('click', hideAddProgressForm);
            elements.confirmAddProgressBtn.addEventListener('click', addNewProgress);
            elements.saveProgressBtn.addEventListener('click', saveProgress);

            // New title search
            elements.newTitleSearch.addEventListener('input', debounce(searchNewTitle, 300));
            document.getElementById('newTitleSearchButton').addEventListener('click', () => searchNewTitle(elements.newTitleSearch.value));

            // Media type change
            elements.mediaTypeSelect.addEventListener('change', updateStatusOptions);

            // Quick add button
            elements.quickAddBtn.addEventListener('click', showAddProgressForm);

            // Card click handlers
            document.addEventListener('click', (e) => {
                if (e.target.closest('.update-progress-btn')) {
                    const btn = e.target.closest('.update-progress-btn');
                    const mediaId = btn.dataset.mediaId;
                    const mediaType = btn.dataset.mediaType;
                    openProgressModal(mediaId, mediaType);
                }

                if (e.target.closest('.suggestion-card')) {
                    const card = e.target.closest('.suggestion-card');
                    const mediaId = card.dataset.mediaId;
                    const mediaType = card.dataset.mediaType;
                    openProgressModal(mediaId, mediaType);
                }
            });

            // Close search results when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('#searchInput') && !e.target.closest('#searchResults')) {
                    elements.searchResults.style.display = 'none';
                }
                if (!e.target.closest('#newTitleSearch') && !e.target.closest('#newTitleResults')) {
                    elements.newTitleResults.style.display = 'none';
                }
            });
        }

        function setupScrollListener() {
            window.addEventListener('scroll', function() {
                if (window.scrollY > 50) {
                    document.querySelector('.navbar').classList.add('scrolled');
                } else {
                    document.querySelector('.navbar').classList.remove('scrolled');
                }
            });
        }

        // Utility Functions
        function debounce(func, timeout = 300) {
            let timer;
            return (...args) => {
                clearTimeout(timer);
                timer = setTimeout(() => { func.apply(this, args); }, timeout);
            };
        }

        function generateStarRating(score) {
            // Convert 10-point scale to 5 stars
            const stars = Math.round(score / 2);
            let starsHTML = '';
            
            for (let i = 1; i <= 5; i++) {
                if (i <= stars) {
                    starsHTML += '<i class="fas fa-star" aria-hidden="true"></i>';
                } else if (i - 0.5 <= stars) {
                    starsHTML += '<i class="fas fa-star-half-alt" aria-hidden="true"></i>';
                } else {
                    starsHTML += '<i class="far fa-star" aria-hidden="true"></i>';
                }
            }
            
            return starsHTML;
        }

        function getProgressPercentage(current, total) {
            if (!total || total === 0) return 0;
            return Math.round((current / total) * 100);
        }

        function showNotification(message) {
            elements.notification.textContent = message;
            elements.notification.classList.add('show');
            
            setTimeout(() => {
                elements.notification.classList.remove('show');
            }, 3000);
        }

        // Main Functions
        async function loadUserProgress() {
            const progress = tracker.getAllProgress();
            let html = '';

            if (Object.keys(progress).length === 0) {
                html = `
                    <div class="text-center py-4">
                        <p>You haven't added any titles to track yet.</p>
                        <button class="btn btn-primary" id="addFirstProgressBtn">
                            <i class="fas fa-plus" aria-hidden="true"></i> Add Your First Title
                        </button>
                    </div>
                `;
                elements.currentProgressItems.innerHTML = html;
                document.getElementById('addFirstProgressBtn').addEventListener('click', showAddProgressForm);
                return;
            }

            // Simulate loading from API
            setTimeout(async () => {
                for (const mediaType in progress) {
                    for (const mediaId in progress[mediaType]) {
                        const progressData = progress[mediaType][mediaId];
                        const media = await tracker.getMedia(mediaId, mediaType);
                        
                        const percentage = progressData.total ? 
                            getProgressPercentage(progressData.current, progressData.total) : 0;
                        
                        html += `
                            <div class="progress-item" data-media-id="${mediaId}" data-media-type="${mediaType}">
                                <div class="d-flex align-items-center mb-3">
                                    <img src="${media.image}" class="media-cover me-3" alt="${media.title} cover">
                                    <div class="flex-grow-1">
                                        <h3 class="h5">${media.title}</h3>
                                        <div class="text-muted mb-2">${mediaType.charAt(0).toUpperCase() + mediaType.slice(1)}</div>
                                        <div class="progress-details">
                                            <div class="progress-input-group">
                                                <label class="form-label">Current ${mediaType === 'anime' ? 'Episode' : 'Chapter'}</label>
                                                <input type="number" class="form-control" value="${progressData.current}" min="1">
                                            </div>
                                            <div class="progress-input-group">
                                                <label class="form-label">Total ${mediaType === 'anime' ? 'Episodes' : 'Chapters'}</label>
                                                <input type="number" class="form-control" value="${progressData.total || ''}" min="1" placeholder="Unknown">
                                            </div>
                                            <div class="progress-input-group">
                                                <label class="form-label">Status</label>
                                                <select class="form-select">
                                                    <option value="watching" ${progressData.status === 'watching' ? 'selected' : ''}>Watching</option>
                                                    <option value="reading" ${progressData.status === 'reading' ? 'selected' : ''}>Reading</option>
                                                    <option value="completed" ${progressData.status === 'completed' ? 'selected' : ''}>Completed</option>
                                                    <option value="on_hold" ${progressData.status === 'on_hold' ? 'selected' : ''}>On Hold</option>
                                                    <option value="dropped" ${progressData.status === 'dropped' ? 'selected' : ''}>Dropped</option>
                                                    <option value="plan_to_watch" ${progressData.status === 'plan_to_watch' ? 'selected' : ''}>Plan to Watch</option>
                                                    <option value="plan_to_read" ${progressData.status === 'plan_to_read' ? 'selected' : ''}>Plan to Read</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="progress-actions">
                                            <button class="btn btn-sm btn-outline-secondary remove-progress-btn">
                                                <i class="fas fa-trash-alt" aria-hidden="true"></i> Remove
                                            </button>
                                            <button class="btn btn-sm btn-primary save-progress-btn">
                                                <i class="fas fa-save" aria-hidden="true"></i> Save
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                ${progressData.total ? `
                                <div class="progress" role="progressbar" aria-valuenow="${percentage}" aria-valuemin="0" aria-valuemax="100" aria-label="Progress: ${percentage}% complete">
                                    <div class="progress-bar" style="width: ${percentage}%"></div>
                                </div>
                                ` : ''}
                            </div>
                        `;
                        
                        elements.currentProgressItems.innerHTML = html;
                        
                        // Add event listeners to new buttons
                        document.querySelectorAll('.remove-progress-btn').forEach(btn => {
                            btn.addEventListener('click', function() {
                                const item = this.closest('.progress-item');
                                const mediaId = item.dataset.mediaId;
                                const mediaType = item.dataset.mediaType;
                                
                                if (confirm('Are you sure you want to remove this title from your progress tracking?')) {
                                    if (tracker.removeProgress(mediaId, mediaType)) {
                                        item.remove();
                                        updateStats();
                                        showNotification('Title removed successfully');
                                        
                                        if (document.querySelectorAll('.progress-item').length === 0) {
                                            loadUserProgress(); // Reload empty state
                                        }
                                    }
                                }
                            });
                        });
                        
                        document.querySelectorAll('.save-progress-btn').forEach(btn => {
                            btn.addEventListener('click', function() {
                                const item = this.closest('.progress-item');
                                const mediaId = item.dataset.mediaId;
                                const mediaType = item.dataset.mediaType;
                                const current = item.querySelector('input[type="number"]:first-of-type').value;
                                const total = item.querySelector('input[type="number"]:last-of-type').value;
                                const status = item.querySelector('select').value;
                                
                                const progress = {
                                    current: parseInt(current),
                                    total: total ? parseInt(total) : null,
                                    status: status,
                                    rating: null
                                };
                                
                                if (tracker.saveProgress(mediaId, mediaType, progress)) {
                                    this.textContent = 'Saved!';
                                    this.classList.remove('btn-primary');
                                    this.classList.add('btn-success');
                                    setTimeout(() => {
                                        this.innerHTML = '<i class="fas fa-save" aria-hidden="true"></i> Save';
                                        this.classList.add('btn-primary');
                                        this.classList.remove('btn-success');
                                    }, 2000);
                                    
                                    updateStats();
                                    showNotification('Progress updated successfully');
                                }
                            });
                        });
                    }
                }
                
                updateStats();
            }, 1000);
        }

        function loadDashboardContent() {
            // Load continue watching/reading
            setTimeout(() => {
                let html = '';
                const progress = tracker.getAllProgress();
                
                // Get first 2 items from each media type
                let continueItems = [];
                
                for (const mediaType in progress) {
                    const items = Object.entries(progress[mediaType]).slice(0, 2);
                    items.forEach(([mediaId, progressData]) => {
                        continueItems.push({ mediaId, mediaType, progressData });
                    });
                }
                
                if (continueItems.length === 0) {
                    // If no progress, show sample data
                    continueItems = [
                        { mediaId: 'jujutsu-kaisen', mediaType: 'anime', progressData: { current: 12, total: 24, status: 'watching' } },
                        { mediaId: 'solo-leveling', mediaType: 'manhwa', progressData: { current: 145, total: 179, status: 'reading' } }
                    ];
                }
                
                continueItems.forEach(async ({ mediaId, mediaType, progressData }) => {
                    const media = await tracker.getMedia(mediaId, mediaType);
                    const percentage = getProgressPercentage(progressData.current, progressData.total || 0);
                    
                    html += `
                        <div class="col-md-6">
                            <div class="card">
                                <div class="position-relative">
                                    <img src="${media.image}" class="card-img-top" alt="${media.title} cover" loading="lazy">
                                    <span class="trending-badge">Rating: ${media.rating.toFixed(1)}</span>
                                    <span class="media-type-badge ${mediaType}-badge">${mediaType.charAt(0).toUpperCase() + mediaType.slice(1)}</span>
                                </div>
                                <div class="card-body">
                                    <h3 class="h5 card-title">${media.title}</h3>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>${mediaType === 'anime' ? 'Episode' : 'Chapter'} ${progressData.current}</span>
                                        <span class="rating-stars" aria-label="Rating: ${media.rating.toFixed(1)}">
                                            ${generateStarRating(media.rating)}
                                        </span>
                                    </div>
                                    <div class="progress mb-2" role="progressbar" aria-valuenow="${percentage}" aria-valuemin="0" aria-valuemax="100" aria-label="Progress: ${percentage}% complete">
                                        <div class="progress-bar" style="width: ${percentage}%"></div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <button class="btn btn-sm btn-outline-primary update-progress-btn" data-media-id="${mediaId}" data-media-type="${mediaType}">Update Progress</button>
                                        <button class="btn btn-sm btn-outline-secondary">Forum</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    elements.continueWatching.innerHTML = html;
                });
                
                // Load upcoming releases
                let upcomingHtml = '';
                SAMPLE_DATA.upcoming.forEach(item => {
                    upcomingHtml += `
                        <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            ${item.title}
                            <span class="badge bg-primary rounded-pill">${item.days} ${item.days === 1 ? 'day' : 'days'}</span>
                        </a>
                    `;
                });
                elements.upcomingReleases.innerHTML = upcomingHtml;
                
                // Load recommendations
                let recommendationsHtml = '';
                SAMPLE_DATA.recommendations.forEach(item => {
                    recommendationsHtml += `
                        <div class="col-md-3">
                            <div class="card h-100 suggestion-card" data-media-id="${item.id}" data-media-type="${item.type}">
                                <div class="position-relative">
                                    <img src="${item.image}" class="card-img-top" alt="${item.title} cover" loading="lazy">
                                    <span class="media-type-badge ${item.type}-badge">${item.type.charAt(0).toUpperCase() + item.type.slice(1)}</span>
                                </div>
                                <div class="card-body">
                                    <h3 class="h5 card-title">${item.title}</h3>
                                    <p class="card-text text-muted">${item.reason}</p>
                                    <div class="rating-stars" aria-label="Rating: ${item.rating.toFixed(1)}">
                                        ${generateStarRating(item.rating)}
                                    </div>
                                    <div class="mt-2">
                                        ${item.genres.map(genre => `<span class="badge bg-secondary me-1">${genre}</span>`).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                elements.recommendations.innerHTML = recommendationsHtml;
                
                // Load forum discussions
                let forumHtml = '';
                SAMPLE_DATA.forum.forEach((item, index) => {
                    forumHtml += `
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h3 class="h5 card-title">${item.title}</h3>
                                    <div class="forum-comment">
                                        <p class="mb-1"><strong>${item.user}:</strong> ${item.comment}</p>
                                        <small class="text-muted">Posted ${item.time} | ${item.comments} comments</small>
                                    </div>
                                    <a href="#" class="btn btn-sm btn-outline-primary mt-2">Join Discussion</a>
                                </div>
                            </div>
                        </div>
                    `;
                });
                elements.forumDiscussions.innerHTML = forumHtml;
            }, 1500);
        }

        function updateStats() {
            const progress = tracker.getAllProgress();
            let animeCount = 0;
            let mangaCount = 0;
            let manhwaCount = 0;
            let novelCount = 0;
            
            if (progress.anime) {
                animeCount = Object.keys(progress.anime).length;
            }
            if (progress.manga) {
                mangaCount = Object.keys(progress.manga).length;
            }
            if (progress.manhwa) {
                manhwaCount = Object.keys(progress.manhwa).length;
            }
            if (progress.novel) {
                novelCount = Object.keys(progress.novel).length;
            }
            
            document.getElementById('anime-count').textContent = animeCount;
            document.getElementById('manga-count').textContent = mangaCount;
            document.getElementById('manhwa-count').textContent = manhwaCount;
            document.getElementById('novel-count').textContent = novelCount;
        }

        async function handleSearch(query) {
            if (!query || query.length < 3) {
                elements.searchResults.style.display = 'none';
                return;
            }
            
            // Show loading state
            elements.searchResults.innerHTML = '<div class="list-group-item">Searching...</div>';
            elements.searchResults.style.display = 'block';
            
            try {
                // Simulate API call with sample data
                setTimeout(() => {
                    const allItems = [
                        ...SAMPLE_DATA.anime,
                        ...SAMPLE_DATA.manga,
                        ...SAMPLE_DATA.manhwa,
                        ...SAMPLE_DATA.novel,
                        ...SAMPLE_DATA.recommendations
                    ];
                    
                    const results = allItems.filter(item => 
                        item.title.toLowerCase().includes(query.toLowerCase())
                    ).slice(0, 5); // Limit to 5 results
                    
                    if (results.length > 0) {
                        elements.searchResults.innerHTML = '';
                        results.forEach(result => {
                            const item = document.createElement('a');
                            item.href = '#';
                            item.className = 'list-group-item list-group-item-action d-flex align-items-center';
                            item.innerHTML = `
                                <img src="${result.image}" alt="${result.title}" style="width: 50px; height: 70px; object-fit: cover; margin-right: 10px;">
                                <div>
                                    <div class="fw-bold">${result.title}</div>
                                    <small class="text-muted">${result.type.charAt(0).toUpperCase() + result.type.slice(1)}</small>
                                </div>
                            `;
                            item.addEventListener('click', (e) => {
                                e.preventDefault();
                                openProgressModal(result.id, result.type);
                                elements.searchResults.style.display = 'none';
                            });
                            elements.searchResults.appendChild(item);
                        });
                    } else {
                        elements.searchResults.innerHTML = '<div class="list-group-item">No results found</div>';
                    }
                }, 500);
            } catch (error) {
                console.error('Search error:', error);
                elements.searchResults.innerHTML = '<div class="list-group-item text-danger">Error searching</div>';
            }
        }

        function showAddProgressForm() {
            document.querySelector('.add-new-progress').style.display = 'block';
            elements.addNewProgressBtn.style.display = 'none';
            elements.newTitleSearch.focus();
        }

        function hideAddProgressForm() {
            document.querySelector('.add-new-progress').style.display = 'none';
            elements.addNewProgressBtn.style.display = 'block';
            elements.newTitleResults.style.display = 'none';
            elements.newTitleSearch.value = '';
            elements.confirmAddProgressBtn.disabled = true;
        }

        function updateStatusOptions() {
            const mediaType = elements.mediaTypeSelect.value;
            const statusSelect = elements.statusSelect;
            
            statusSelect.innerHTML = '';
            
            if (mediaType === 'anime') {
                statusSelect.innerHTML = `
                    <option value="watching" selected>Watching</option>
                    <option value="completed">Completed</option>
                    <option value="on_hold">On Hold</option>
                    <option value="dropped">Dropped</option>
                    <option value="plan_to_watch">Plan to Watch</option>
                `;
            } else {
                statusSelect.innerHTML = `
                    <option value="reading" selected>Reading</option>
                    <option value="completed">Completed</option>
                    <option value="on_hold">On Hold</option>
                    <option value="dropped">Dropped</option>
                    <option value="plan_to_read">Plan to Read</option>
                `;
            }
        }

        async function searchNewTitle(query) {
            if (!query || query.length < 3) {
                elements.newTitleResults.style.display = 'none';
                elements.confirmAddProgressBtn.disabled = true;
                return;
            }
            
            // Show loading state
            elements.newTitleResults.innerHTML = '<div class="list-group-item">Searching...</div>';
            elements.newTitleResults.style.display = 'block';
            
            try {
                // Simulate API call with sample data
                setTimeout(() => {
                    const allItems = [
                        ...SAMPLE_DATA.anime,
                        ...SAMPLE_DATA.manga,
                        ...SAMPLE_DATA.manhwa,
                        ...SAMPLE_DATA.novel,
                        ...SAMPLE_DATA.recommendations
                    ];
                    
                    const results = allItems.filter(item => 
                        item.title.toLowerCase().includes(query.toLowerCase())
                    ).slice(0, 5); // Limit to 5 results
                    
                    if (results.length > 0) {
                        elements.newTitleResults.innerHTML = '';
                        results.forEach(result => {
                            const item = document.createElement('a');
                            item.href = '#';
                            item.className = 'list-group-item list-group-item-action d-flex align-items-center';
                            item.dataset.mediaId = result.id;
                            item.dataset.mediaType = result.type;
                            item.innerHTML = `
                                <img src="${result.image}" alt="${result.title}" style="width: 50px; height: 70px; object-fit: cover; margin-right: 10px;">
                                <div>
                                    <div class="fw-bold">${result.title}</div>
                                    <small class="text-muted">${result.type.charAt(0).toUpperCase() + result.type.slice(1)}</small>
                                </div>
                            `;
                            item.addEventListener('click', (e) => {
                                e.preventDefault();
                                elements.newTitleSearch.value = result.title;
                                elements.mediaTypeSelect.value = result.type;
                                elements.newTitleResults.style.display = 'none';
                                elements.confirmAddProgressBtn.disabled = false;
                                updateStatusOptions();
                            });
                            elements.newTitleResults.appendChild(item);
                        });
                    } else {
                        elements.newTitleResults.innerHTML = '<div class="list-group-item">No results found</div>';
                        elements.confirmAddProgressBtn.disabled = true;
                    }
                }, 500);
            } catch (error) {
                console.error('Search error:', error);
                elements.newTitleResults.innerHTML = '<div class="list-group-item text-danger">Error searching</div>';
                elements.confirmAddProgressBtn.disabled = true;
            }
        }

        function addNewProgress() {
            const title = elements.newTitleSearch.value;
            const mediaType = elements.mediaTypeSelect.value;
            const current = elements.currentProgressInput.value;
            const total = elements.totalProgressInput.value || null;
            const status = elements.statusSelect.value;
            
            if (!title) {
                alert('Please select a title from the search results');
                return;
            }
            
            // Find the selected media (in a real app, this would come from the API)
            const selectedItem = document.querySelector('#newTitleResults a.active');
            const mediaId = selectedItem?.dataset.mediaId || title.toLowerCase().replace(/\s+/g, '-');
            
            const progress = {
                current: parseInt(current),
                total: total ? parseInt(total) : null,
                status: status,
                rating: null
            };
            
            if (tracker.saveProgress(mediaId, mediaType, progress)) {
                showNotification(`Added ${title} to your ${mediaType} list!`);
                hideAddProgressForm();
                loadUserProgress();
                loadDashboardContent();
            }
        }

        async function openProgressModal(mediaId, mediaType) {
            // Show loading state
            elements.mediaTitle.value = 'Loading...';
            elements.currentChapter.value = '';
            elements.totalChapters.value = '';
            
            // Get media details
            const media = await tracker.getMedia(mediaId, mediaType);
            const progress = tracker.getProgress(mediaId, mediaType);
            
            // Update modal
            elements.mediaTitle.value = media.title;
            elements.currentChapter.value = progress.current;
            elements.totalChapters.value = progress.total || '';
            elements.userRating.value = progress.rating || '4';
            elements.statusSelectModal.value = progress.status || (mediaType === 'anime' ? 'watching' : 'reading');
            
            // Store current media
            tracker.currentMedia = { id: mediaId, type: mediaType };
            
            // Show modal
            progressModal.show();
        }

        function saveProgress() {
            const { id, type } = tracker.currentMedia;
            const current = elements.currentChapter.value;
            const total = elements.totalChapters.value || null;
            const rating = elements.userRating.value;
            const status = elements.statusSelectModal.value;
            
            const progress = {
                current: parseInt(current),
                total: total ? parseInt(total) : null,
                status: status,
                rating: rating
            };
            
            if (tracker.saveProgress(id, type, progress)) {
                progressModal.hide();
                showNotification('Progress updated successfully');
                loadUserProgress();
                loadDashboardContent();
            }
        }
    </script>
</body>
</html>
